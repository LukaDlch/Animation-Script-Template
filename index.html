<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animation Brief</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0d0d0d;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #252525;
            --border-color: #333;
            --border-highlight: #444;
            --text-primary: #ffffff;
            --text-secondary: #888;
            --text-muted: #555;
            --accent: #DCCE9E;
            --accent-hover: #E8DDB5;
            --accent-subtle: rgba(220, 206, 158, 0.1);
            --radius: 8px;
            --radius-lg: 12px;
        }

        [data-theme="alta"] {
            --accent: #7C81FA;
            --accent-hover: #9599FB;
            --accent-subtle: rgba(124, 129, 250, 0.1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        header {
            margin-bottom: 40px;
        }

        h1 {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 15px;
        }

        .section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 24px;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .section-description {
            font-size: 13px;
            color: var(--text-muted);
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        .form-row:last-child {
            margin-bottom: 0;
        }

        .form-row.single {
            grid-template-columns: 1fr;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        input[type="text"],
        input[type="url"],
        textarea {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: 12px 14px;
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        input[type="text"]:focus,
        input[type="url"]:focus,
        textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-subtle);
        }

        textarea {
            resize: vertical;
            min-height: 70px;
        }

        /* Company Toggle */
        .company-toggle {
            display: flex;
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            padding: 4px;
            gap: 4px;
        }

        .company-toggle button {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px 20px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            font-family: inherit;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .company-toggle button svg {
            width: 18px;
            height: 18px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .company-toggle button.active {
            background: var(--accent);
            color: var(--bg-primary);
        }

        .company-toggle button.active svg {
            opacity: 1;
        }

        .company-toggle button:hover:not(.active) {
            color: var(--text-primary);
            background: var(--bg-secondary);
        }

        .company-toggle button:hover:not(.active) svg {
            opacity: 0.8;
        }

        /* Mood Tags */
        .mood-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .mood-tag {
            padding: 8px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            font-size: 13px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .mood-tag:hover {
            border-color: var(--border-highlight);
            color: var(--text-primary);
        }

        .mood-tag.selected {
            background: var(--accent-subtle);
            border-color: var(--accent);
            color: var(--accent);
        }

        /* Platform Checkboxes */
        .platform-checkboxes {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .platform-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.2s;
        }

        .platform-checkbox:hover {
            border-color: var(--border-highlight);
        }

        .platform-checkbox input {
            display: none;
        }

        .checkbox-custom {
            width: 18px;
            height: 18px;
            border: 2px solid var(--border-highlight);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .checkbox-custom::after {
            content: '';
            width: 10px;
            height: 10px;
            background: var(--accent);
            border-radius: 2px;
            opacity: 0;
            transform: scale(0);
            transition: all 0.2s;
        }

        .platform-checkbox input:checked + .checkbox-custom {
            border-color: var(--accent);
        }

        .platform-checkbox input:checked + .checkbox-custom::after {
            opacity: 1;
            transform: scale(1);
        }

        .platform-checkbox input:checked ~ .platform-name {
            color: var(--accent);
        }

        .platform-name {
            font-size: 13px;
            color: var(--text-secondary);
            transition: color 0.2s;
        }

        /* Date Input */
        .date-input {
            width: 100%;
            padding: 12px 14px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
            cursor: pointer;
            transition: border-color 0.2s;
        }

        .date-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .date-input::-webkit-calendar-picker-indicator {
            filter: invert(1);
            cursor: pointer;
        }

        /* Easing Selector */
        .easing-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        /* Format Selector */
        .format-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .format-option {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            padding: 14px 16px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .format-option:hover {
            border-color: var(--border-highlight);
        }

        .format-option.selected {
            border-color: var(--accent);
            background: var(--accent-subtle);
        }

        .format-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .format-name {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .format-option.selected .format-name {
            color: var(--accent);
        }

        .format-duration {
            font-size: 11px;
            color: var(--text-muted);
        }

        .format-timeline {
            display: flex;
            height: 24px;
            border-radius: 4px;
            overflow: hidden;
            background: var(--bg-primary);
        }

        .format-segment {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 9px;
            font-weight: 500;
            color: var(--text-secondary);
            border-right: 1px solid var(--bg-primary);
            transition: all 0.2s;
        }

        .format-segment:last-child {
            border-right: none;
        }

        .format-segment.seg-hook { background: rgba(255, 255, 255, 0.08); }
        .format-segment.seg-core { background: rgba(255, 255, 255, 0.15); }
        .format-segment.seg-cta { background: rgba(255, 255, 255, 0.05); }

        .format-option.selected .format-segment.seg-hook { background: var(--accent); color: var(--bg-primary); }
        .format-option.selected .format-segment.seg-core { background: var(--accent); opacity: 0.6; color: var(--bg-primary); }
        .format-option.selected .format-segment.seg-cta { background: var(--accent); opacity: 0.35; color: var(--bg-primary); }

        .easing-option {
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            padding: 16px 12px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .easing-option:hover {
            border-color: var(--border-highlight);
        }

        .easing-option.selected {
            border-color: var(--accent);
            background: var(--accent-subtle);
        }

        .easing-preview {
            height: 40px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .easing-track {
            position: absolute;
            width: 80%;
            height: 2px;
            background: var(--border-color);
            border-radius: 1px;
        }

        .easing-ball {
            width: 14px;
            height: 14px;
            background: var(--accent);
            border-radius: 50%;
            position: relative;
            z-index: 1;
        }

        .easing-name {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .easing-option.selected .easing-name {
            color: var(--accent);
        }

        /* Synced animations - all 2s duration, same keyframes */
        @keyframes moveLinear {
            0% { transform: translateX(-40px); }
            50% { transform: translateX(40px); }
            100% { transform: translateX(-40px); }
        }

        @keyframes moveEase {
            0% { transform: translateX(-40px); }
            50% { transform: translateX(40px); }
            100% { transform: translateX(-40px); }
        }

        @keyframes moveBounce {
            0% { transform: translateX(-40px); }
            50% { transform: translateX(40px); }
            100% { transform: translateX(-40px); }
        }

        .ball-linear {
            animation: moveLinear 3s linear infinite;
            animation-play-state: paused;
        }

        .ball-ease {
            animation: moveEase 3s cubic-bezier(0.753, 0.012, 0.243, 0.995) infinite;
            animation-play-state: paused;
        }

        .ball-bounce {
            animation: moveBounce 3s cubic-bezier(0.2, 1.8, 0.4, 1) infinite;
            animation-play-state: paused;
        }

        .easing-option.selected .ball-linear,
        .easing-option.selected .ball-ease,
        .easing-option.selected .ball-bounce {
            animation-play-state: running;
        }

        /* File Upload */
        .file-upload {
            border: 2px dashed var(--border-color);
            border-radius: var(--radius);
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .file-upload:hover,
        .file-upload.dragover {
            border-color: var(--accent);
            background: var(--accent-subtle);
        }

        .file-upload-icon {
            width: 32px;
            height: 32px;
            margin: 0 auto 8px;
            opacity: 0.5;
        }

        .file-upload-text {
            color: var(--text-secondary);
            font-size: 13px;
        }

        .file-upload-text span {
            color: var(--accent);
        }

        .file-upload input {
            display: none;
        }

        .uploaded-files {
            margin-top: 12px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .uploaded-file {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 10px;
            background: var(--bg-tertiary);
            border-radius: var(--radius);
            font-size: 12px;
        }

        .uploaded-file button {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0;
            display: flex;
        }

        .uploaded-file button:hover {
            color: var(--accent);
        }

        /* Segments */
        .segments-container {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .segment {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-left: 3px solid var(--accent);
            border-radius: var(--radius-lg);
            padding: 20px;
        }

        .segment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .segment-title-row {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .segment-number {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--accent);
            white-space: nowrap;
        }

        .segment-name-input {
            flex: 1;
            background: transparent;
            border: none;
            border-bottom: 1px solid transparent;
            padding: 4px 0;
            color: var(--text-primary);
            font-size: 15px;
            font-weight: 500;
            font-family: inherit;
        }

        .segment-name-input:focus {
            outline: none;
            border-bottom-color: var(--accent);
        }

        .segment-name-input::placeholder {
            color: var(--text-muted);
            font-weight: 400;
        }

        .segment-delete {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s;
            margin-left: 12px;
        }

        .segment-delete:hover {
            color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }

        /* Time Slider */
        .time-slider-container {
            margin-bottom: 16px;
        }

        .time-display {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .time-value {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .time-value strong {
            color: var(--accent);
            font-weight: 600;
        }

        .slider-wrapper {
            position: relative;
            height: 32px;
            display: flex;
            align-items: center;
        }

        .slider-track {
            position: absolute;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--bg-tertiary);
            border-radius: 2px;
        }

        .slider-range {
            position: absolute;
            height: 4px;
            background: var(--accent);
            border-radius: 2px;
            pointer-events: none;
        }

        .slider-handle {
            position: absolute;
            width: 18px;
            height: 18px;
            background: var(--accent);
            border: 2px solid var(--bg-primary);
            border-radius: 50%;
            cursor: grab;
            transform: translateX(-50%);
            z-index: 2;
            transition: transform 0.1s;
            touch-action: none;
        }

        .slider-handle:hover {
            transform: translateX(-50%) scale(1.15);
        }

        .slider-handle:active {
            cursor: grabbing;
        }

        .slider-handle.disabled {
            background: var(--text-muted);
            cursor: default;
        }

        .slider-handle.disabled:hover {
            transform: translateX(-50%);
        }

        .slider-ticks {
            display: flex;
            justify-content: space-between;
            margin-top: 6px;
            padding: 0 9px;
        }

        .slider-tick {
            font-size: 10px;
            color: var(--text-muted);
        }

        /* Add Segment Button */
        .add-segment-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px;
            background: transparent;
            border: 2px dashed var(--border-color);
            border-radius: var(--radius-lg);
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
        }

        .add-segment-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
            background: var(--accent-subtle);
        }

        /* Estimated Price */
        .price-section {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 24px;
            margin-bottom: 20px;
        }

        .price-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .price-title {
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
        }

        .price-duration {
            text-align: right;
        }

        .price-duration-value {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .price-duration-label {
            font-size: 12px;
            color: var(--text-muted);
        }

        .price-breakdown {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .price-calc {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .price-calc span {
            color: var(--text-muted);
        }

        .price-estimate-wrapper {
            text-align: right;
        }

        .price-estimate-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 2px;
        }

        .price-value {
            font-size: 28px;
            font-weight: 300;
            color: var(--accent);
            letter-spacing: -0.5px;
        }

        .price-value .estimate-symbol {
            font-size: 18px;
            opacity: 0.7;
            margin-right: 2px;
        }

        /* Generate Button */
        .generate-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            padding: 16px 32px;
            background: var(--accent);
            border: none;
            border-radius: var(--radius-lg);
            color: white;
            font-size: 15px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 8px;
        }

        .generate-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .generate-btn:active {
            transform: translateY(0);
        }

        /* Responsive */
        @media (max-width: 600px) {
            .container {
                padding: 20px 16px;
            }

            h1 {
                font-size: 22px;
            }

            .section {
                padding: 16px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .easing-options {
                grid-template-columns: 1fr;
            }

            .company-toggle {
                flex-direction: column;
            }

            .company-toggle button {
                padding: 12px 16px;
            }

            .mood-tags {
                gap: 8px;
            }

            .mood-tag {
                padding: 6px 12px;
                font-size: 12px;
            }

            .format-option {
                padding: 12px;
            }

            .format-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 4px;
            }

            .format-timeline {
                height: 20px;
            }

            .format-segment {
                font-size: 7px;
            }

            .slider-handle {
                width: 24px;
                height: 24px;
            }

            .slider-wrapper {
                height: 40px;
            }

            .segment {
                padding: 16px;
            }

            .segment-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .segment-delete {
                margin-left: 0;
            }

            .price-header {
                flex-direction: column;
                gap: 12px;
            }

            .price-duration {
                text-align: left;
            }

            .price-breakdown {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .price-estimate-wrapper {
                text-align: left;
            }

            .price-value {
                font-size: 24px;
            }

            .file-upload {
                padding: 24px 16px;
            }

            .easing-preview {
                height: 50px;
            }

            .easing-ball {
                width: 10px;
                height: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Principle Animation Brief</h1>
        </header>

        <!-- Project Info Section -->
        <div class="section">
            <div class="section-title">Project Information</div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>Project Name</label>
                    <input type="text" id="projectName" placeholder="e.g., S2 Launch Animation">
                </div>
                <div class="form-group">
                    <label>Project</label>
                    <div class="company-toggle">
                        <button type="button" class="active" data-company="Dexari">
                            <svg viewBox="0 0 817 736" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path d="M574.301 164.734C544.107 85.7449 593.192 18.1546 710.56 28.4751C636.206 7.60066 544.261 29.0221 506.257 89.3154C463.392 157.32 476.122 211.557 510.163 262.263C540.932 308.093 586.708 349.385 608.99 379.888C651.832 438.536 659.712 477.099 660.551 536.721C689.958 489.821 702.784 464.112 708.687 436.572C722.339 354.862 699.56 309.688 634.234 246.687C604.237 219.717 590.271 202.418 574.301 164.734Z"/>
                                <path d="M699.199 15.7769C536.995 -41.6391 363.507 61.3775 358.047 264.281C299.581 319.364 265.536 345.631 204.728 384.077C123.436 436.917 107.635 447.33 48.7738 506.191C-27.4808 582.446 -10.0636 709.984 71.4374 736H386.551C384.479 721.93 374.683 709.984 360.535 709.984H76.8607C6.14433 686.958 12.7151 569.2 96.3294 498.197V686.958H272.056C266.706 676.203 254.449 663.785 237.78 663.785H204.728C234.916 642.22 248.908 628.452 264.332 598.612C271.482 584.777 281.162 552.541 288.47 520.887L289.881 543.311C367.555 537.889 407.452 527.57 471.292 493.776L435.041 427.864H456.279L635.508 736H742.657C741.499 727.813 733.412 706.739 711.194 706.739H671.478C656.662 656.166 651.446 623.947 642.155 566.557L642.143 566.479C641.679 563.615 641.205 560.688 640.72 557.693C623.649 459.888 597.106 416.858 536.995 348.991C332.394 142.264 515.615 -19.5227 699.199 15.7769Z"/>
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M767.236 67.7963C783.571 77.1578 791.891 81.9255 809.726 89.7129C816.831 92.4846 824.58 97.8709 799.665 100.653C797.095 100.854 796.86 104.29 810.89 112.03C813.211 113.311 812.944 116.657 812.157 126.518C811.885 129.935 811.549 134.134 811.238 139.3C807.257 143.836 796.804 154.18 789.79 156.962C782.775 159.743 778.33 158.939 777.171 158.183C779.691 162.214 787.026 167.925 794.404 163.087C800.573 159.042 804.012 155.335 805.883 153.319C806.249 152.924 806.555 152.594 806.81 152.339C806.934 152.215 807.063 152.08 807.196 151.94C808.888 150.17 811.238 147.71 811.238 159.256C811.238 171.714 805.073 179.937 801.991 182.491C798.78 186.221 787.373 191.982 767.43 185.183C761.339 182.775 746.296 178.554 734.852 180.933C723.407 183.313 715.541 196.278 713.038 202.463C710.729 207.039 707.921 220.291 715.163 236.696C717.589 242.191 720.859 247.799 724.431 253.924C734.188 270.656 746.191 291.241 749.351 323.887C752.803 359.563 745.195 398.691 740.959 413.796C745.258 380.724 734.71 297.997 658.123 231.666C581.536 165.334 589.509 109.392 603.068 89.7129C593.322 64.8924 619.221 31.5623 648.834 57.1855C659.221 48.9783 698.087 28.3022 729.636 46.6648C746.636 55.9909 758.17 62.6011 767.236 67.7963ZM721.344 70.94C730.561 64.574 740.686 76.2689 745.318 82.1677C738.904 79.8319 726.559 77.6975 721.344 80.835C713.455 85.582 709.678 84.1297 708.173 82.5065C703.267 76.9411 697.186 76.4198 694.656 76.4734C694.246 76.4962 693.848 76.5232 693.464 76.5561C693.464 76.5561 693.903 76.4893 694.656 76.4734C695.82 76.4087 697.086 76.3783 698.428 76.346C705.263 76.1818 714.061 75.9705 721.344 70.94Z"/>
                            </svg>
                            Dexari
                        </button>
                        <button type="button" data-company="Alta">
                            <svg viewBox="0 0 268 230" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M134 0L0 229.211H268L134 0ZM69.8563 188.552L134 78.8837L198.144 188.552L134 151.949L69.8563 188.552Z"/>
                            </svg>
                            Alta
                        </button>
                    </div>
                </div>
            </div>

            <div class="form-row single">
                <div class="form-group">
                    <label>Platforms</label>
                    <div class="platform-checkboxes">
                        <label class="platform-checkbox">
                            <input type="checkbox" value="X (Twitter)">
                            <span class="checkbox-custom"></span>
                            <span class="platform-name">X (Twitter)</span>
                        </label>
                        <label class="platform-checkbox">
                            <input type="checkbox" value="Instagram Reels">
                            <span class="checkbox-custom"></span>
                            <span class="platform-name">Instagram Reels</span>
                        </label>
                        <label class="platform-checkbox">
                            <input type="checkbox" value="TikTok">
                            <span class="checkbox-custom"></span>
                            <span class="platform-name">TikTok</span>
                        </label>
                        <label class="platform-checkbox">
                            <input type="checkbox" value="YouTube Shorts">
                            <span class="checkbox-custom"></span>
                            <span class="platform-name">YouTube Shorts</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="form-row single">
                <div class="form-group">
                    <label>Goal</label>
                    <textarea id="projectGoal" placeholder="What is the goal of this animation and who is the target audience? (e.g., Drive sign-ups for Season 2 launch, targeting existing DeFi users)"></textarea>
                </div>
            </div>

            <div class="form-row single">
                <div class="form-group">
                    <label>Overall Mood / Tone</label>
                    <div class="mood-tags">
                        <div class="mood-tag" data-mood="Professional">Professional</div>
                        <div class="mood-tag" data-mood="Playful">Playful</div>
                        <div class="mood-tag" data-mood="Energetic">Energetic</div>
                        <div class="mood-tag" data-mood="Calm">Calm</div>
                        <div class="mood-tag" data-mood="Techy">Techy</div>
                        <div class="mood-tag" data-mood="Minimal">Minimal</div>
                        <div class="mood-tag" data-mood="Bold">Bold</div>
                        <div class="mood-tag" data-mood="Elegant">Elegant</div>
                    </div>
                </div>
            </div>

            <div class="form-row single">
                <div class="form-group">
                    <label>Animation Feel</label>
                    <div class="easing-options">
                        <div class="easing-option selected" data-easing="linear">
                            <div class="easing-preview">
                                <div class="easing-track"></div>
                                <div class="easing-ball ball-linear"></div>
                            </div>
                            <div class="easing-name">Linear</div>
                        </div>
                        <div class="easing-option" data-easing="ease">
                            <div class="easing-preview">
                                <div class="easing-track"></div>
                                <div class="easing-ball ball-ease"></div>
                            </div>
                            <div class="easing-name">Easy Easing</div>
                        </div>
                        <div class="easing-option" data-easing="bounce">
                            <div class="easing-preview">
                                <div class="easing-track"></div>
                                <div class="easing-ball ball-bounce"></div>
                            </div>
                            <div class="easing-name">Bounce</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-row single">
                <div class="form-group">
                    <label>Animation Format</label>
                    <div class="format-options">
                        <div class="format-option selected" data-format="ad">
                            <div class="format-header">
                                <span class="format-name">Ad / Promo</span>
                                <span class="format-duration">~16s</span>
                            </div>
                            <div class="format-timeline">
                                <div class="format-segment seg-hook" style="width: 18.75%">Hook 3s</div>
                                <div class="format-segment seg-core" style="width: 62.5%">Core 10s</div>
                                <div class="format-segment seg-cta" style="width: 18.75%">CTA 3s</div>
                            </div>
                        </div>
                        <div class="format-option" data-format="announcement">
                            <div class="format-header">
                                <span class="format-name">Announcement</span>
                                <span class="format-duration">~12s</span>
                            </div>
                            <div class="format-timeline">
                                <div class="format-segment seg-hook" style="width: 16.67%">Intro 2s</div>
                                <div class="format-segment seg-core" style="width: 50%">Reveal 6s</div>
                                <div class="format-segment seg-cta" style="width: 33.33%">Details 4s</div>
                            </div>
                        </div>
                        <div class="format-option" data-format="feature">
                            <div class="format-header">
                                <span class="format-name">Feature Showcase</span>
                                <span class="format-duration">~13s</span>
                            </div>
                            <div class="format-timeline">
                                <div class="format-segment seg-hook" style="width: 23.08%">Setup 3s</div>
                                <div class="format-segment seg-core" style="width: 53.84%">Demo 7s</div>
                                <div class="format-segment seg-cta" style="width: 23.08%">Outro 3s</div>
                            </div>
                        </div>
                        <div class="format-option" data-format="tutorial">
                            <div class="format-header">
                                <span class="format-name">Tutorial / Explainer</span>
                                <span class="format-duration">~25s</span>
                            </div>
                            <div class="format-timeline">
                                <div class="format-segment seg-hook" style="width: 12%">Intro 3s</div>
                                <div class="format-segment seg-core" style="width: 72%">Steps 18s</div>
                                <div class="format-segment seg-cta" style="width: 16%">Summary 4s</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- References Section -->
        <div class="section">
            <div class="section-title">References</div>
            
            <div class="form-row single">
                <div class="form-group">
                    <label>Reference Images</label>
                    <div class="file-upload" id="referenceUpload">
                        <svg class="file-upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                        <div class="file-upload-text">
                            Drop files here or <span>browse</span>
                        </div>
                        <input type="file" id="referenceFiles" multiple accept="image/*,.gif,.mp4,.mov">
                    </div>
                    <div class="uploaded-files" id="uploadedFiles"></div>
                </div>
            </div>

            <div class="form-row single">
                <div class="form-group">
                    <label>Reference Links</label>
                    <textarea id="referenceLinks" placeholder="Paste links to reference animations or videos (one per line)"></textarea>
                </div>
            </div>
        </div>

        <!-- Segments Section -->
        <div class="section">
            <div class="section-title">Animation Segments</div>
            <p class="section-description">A segment represents a sequence of frames where a specific copy or layout is animated. Create a segment for each title, message, or UI layout being showcased. Define what appears on screen and how it should be displayed in each segment.</p>
            <div class="segments-container" id="segmentsContainer"></div>
            <button type="button" class="add-segment-btn" id="addSegmentBtn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"/>
                    <line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
                Add Segment
            </button>
        </div>

        <!-- Deadline Section -->
        <div class="section">
            <div class="section-title">Deadline</div>
            <div class="form-row single">
                <div class="form-group">
                    <label>Expected Final Version Date</label>
                    <input type="date" id="deadlineDate" class="date-input">
                </div>
            </div>
        </div>

        <!-- Estimated Price -->
        <div class="price-section">
            <div class="price-header">
                <div class="price-title">Estimate</div>
                <div class="price-duration">
                    <div class="price-duration-value" id="totalDuration">0.0s</div>
                    <div class="price-duration-label">Total Duration</div>
                </div>
            </div>
            <div class="price-breakdown">
                <div class="price-calc">
                    <span id="priceCalc">0.0s × $17.50/s</span>
                </div>
                <div class="price-estimate-wrapper">
                    <div class="price-estimate-label">Estimated Price</div>
                    <div class="price-value"><span class="estimate-symbol">±</span><span id="priceValue">$0.00</span></div>
                </div>
            </div>
        </div>

        <!-- Generate Button -->
        <button type="button" class="generate-btn" id="generateBtn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14 2 14 8 20 8"/>
                <line x1="16" y1="13" x2="8" y2="13"/>
                <line x1="16" y1="17" x2="8" y2="17"/>
            </svg>
            Generate PDF Brief
        </button>
    </div>

    <script>
        // State
        let segments = [];
        let selectedCompany = 'Dexari';
        let selectedMoods = [];
        let selectedPlatforms = [];
        let selectedEasing = 'linear';
        let selectedFormat = 'ad';
        let uploadedFiles = [];
        const MAX_DURATION = 20;
        const RATE_PER_SECOND = 17.5;

        const easingNames = {
            'linear': 'Linear',
            'ease': 'Easy Easing',
            'bounce': 'Bounce'
        };

        const formatNames = {
            'ad': 'Ad / Promo',
            'announcement': 'Announcement',
            'feature': 'Feature Showcase',
            'tutorial': 'Tutorial / Explainer'
        };

        // Company toggle
        document.querySelectorAll('.company-toggle button').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.company-toggle button').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedCompany = btn.dataset.company;
                
                // Update theme
                if (selectedCompany === 'Alta') {
                    document.documentElement.setAttribute('data-theme', 'alta');
                } else {
                    document.documentElement.removeAttribute('data-theme');
                }
            });
        });

        // Mood tags
        document.querySelectorAll('.mood-tag').forEach(tag => {
            tag.addEventListener('click', () => {
                tag.classList.toggle('selected');
                const mood = tag.dataset.mood;
                if (tag.classList.contains('selected')) {
                    selectedMoods.push(mood);
                } else {
                    selectedMoods = selectedMoods.filter(m => m !== mood);
                }
            });
        });

        // Platform checkboxes
        document.querySelectorAll('.platform-checkbox input').forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                const platform = checkbox.value;
                if (checkbox.checked) {
                    selectedPlatforms.push(platform);
                } else {
                    selectedPlatforms = selectedPlatforms.filter(p => p !== platform);
                }
            });
        });

        // Easing selection
        document.querySelectorAll('.easing-option').forEach(option => {
            option.addEventListener('click', () => {
                document.querySelectorAll('.easing-option').forEach(o => o.classList.remove('selected'));
                option.classList.add('selected');
                selectedEasing = option.dataset.easing;
            });
        });

        // Format selection
        document.querySelectorAll('.format-option').forEach(option => {
            option.addEventListener('click', () => {
                document.querySelectorAll('.format-option').forEach(o => o.classList.remove('selected'));
                option.classList.add('selected');
                selectedFormat = option.dataset.format;
            });
        });

        // File upload
        const fileUpload = document.getElementById('referenceUpload');
        const fileInput = document.getElementById('referenceFiles');
        const uploadedFilesContainer = document.getElementById('uploadedFiles');

        fileUpload.addEventListener('click', () => fileInput.click());
        
        fileUpload.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUpload.classList.add('dragover');
        });

        fileUpload.addEventListener('dragleave', () => {
            fileUpload.classList.remove('dragover');
        });

        fileUpload.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUpload.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        });

        fileInput.addEventListener('change', () => {
            handleFiles(fileInput.files);
        });

        function handleFiles(files) {
            for (const file of files) {
                uploadedFiles.push(file);
            }
            renderUploadedFiles();
        }

        function renderUploadedFiles() {
            uploadedFilesContainer.innerHTML = uploadedFiles.map((file, i) => `
                <div class="uploaded-file">
                    <span>${file.name}</span>
                    <button type="button" onclick="removeFile(${i})">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>
            `).join('');
        }

        function removeFile(index) {
            uploadedFiles.splice(index, 1);
            renderUploadedFiles();
        }

        // Segments
        function getLastSegmentEnd() {
            if (segments.length === 0) return 0;
            return segments[segments.length - 1].endTime;
        }

        function addSegment() {
            const startTime = getLastSegmentEnd();
            const endTime = Math.min(startTime + 3, MAX_DURATION);
            
            if (startTime >= MAX_DURATION) {
                alert('Maximum duration reached (30 seconds)');
                return;
            }

            segments.push({
                id: Date.now(),
                name: '',
                startTime: startTime,
                endTime: endTime,
                copy: '',
                visualDescription: ''
            });

            renderSegments();
        }

        function removeSegment(id) {
            const index = segments.findIndex(s => s.id === id);
            segments.splice(index, 1);
            
            // Recalculate times
            for (let i = index; i < segments.length; i++) {
                const prevEnd = i === 0 ? 0 : segments[i - 1].endTime;
                const duration = segments[i].endTime - segments[i].startTime;
                segments[i].startTime = prevEnd;
                segments[i].endTime = Math.min(prevEnd + duration, MAX_DURATION);
            }
            
            renderSegments();
        }

        function renderSegments() {
            const container = document.getElementById('segmentsContainer');
            container.innerHTML = segments.map((segment, index) => {
                const isFirst = index === 0;
                const startPercent = (segment.startTime / MAX_DURATION) * 100;
                const endPercent = (segment.endTime / MAX_DURATION) * 100;

                return `
                <div class="segment" data-id="${segment.id}">
                    <div class="segment-header">
                        <div class="segment-title-row">
                            <span class="segment-number">Segment ${index + 1}</span>
                            <input type="text" class="segment-name-input" value="${segment.name}" 
                                placeholder="Segment name..." 
                                oninput="updateSegment(${segment.id}, 'name', this.value)">
                        </div>
                        <button type="button" class="segment-delete" onclick="removeSegment(${segment.id})">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3 6 5 6 21 6"/>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                            </svg>
                        </button>
                    </div>

                    <div class="time-slider-container">
                        <div class="time-display">
                            <span class="time-value">Start: <strong>${segment.startTime.toFixed(1)}s</strong></span>
                            <span class="time-value">End: <strong>${segment.endTime.toFixed(1)}s</strong></span>
                        </div>
                        <div class="slider-wrapper" data-segment-id="${segment.id}" data-index="${index}">
                            <div class="slider-track"></div>
                            <div class="slider-range" style="left: ${startPercent}%; width: ${endPercent - startPercent}%"></div>
                            <div class="slider-handle ${isFirst ? '' : 'disabled'}" data-type="start" style="left: ${startPercent}%"></div>
                            <div class="slider-handle" data-type="end" style="left: ${endPercent}%"></div>
                        </div>
                        <div class="slider-ticks">
                            <span class="slider-tick">0s</span>
                            <span class="slider-tick">5s</span>
                            <span class="slider-tick">10s</span>
                            <span class="slider-tick">15s</span>
                            <span class="slider-tick">20s</span>
                        </div>
                    </div>

                    <div class="form-group" style="margin-bottom: 12px;">
                        <label>On-Screen Copy</label>
                        <textarea placeholder="What text should appear on screen?" 
                            oninput="updateSegment(${segment.id}, 'copy', this.value)">${segment.copy}</textarea>
                    </div>

                    <div class="form-group">
                        <label>Visual Description</label>
                        <textarea placeholder="Describe what should happen visually..." 
                            oninput="updateSegment(${segment.id}, 'visualDescription', this.value)">${segment.visualDescription}</textarea>
                    </div>
                </div>
            `}).join('');

            initSliders();
            updatePrice();
        }

        function updateSegment(id, field, value) {
            const segment = segments.find(s => s.id === id);
            if (segment) segment[field] = value;
        }

        function initSliders() {
            document.querySelectorAll('.slider-wrapper').forEach(wrapper => {
                const segmentId = parseInt(wrapper.dataset.segmentId);
                const handles = wrapper.querySelectorAll('.slider-handle');

                handles.forEach(handle => {
                    if (handle.classList.contains('disabled')) return;
                    
                    const handleDrag = (startEvent) => {
                        startEvent.preventDefault();
                        startEvent.stopPropagation();
                        
                        const handleType = handle.dataset.type;
                        
                        const getClientX = (e) => {
                            if (e.touches && e.touches.length > 0) {
                                return e.touches[0].clientX;
                            }
                            return e.clientX;
                        };
                        
                        const onMove = (e) => {
                            const rect = wrapper.getBoundingClientRect();
                            let percent = (getClientX(e) - rect.left) / rect.width;
                            percent = Math.max(0, Math.min(1, percent));
                            const rawTime = percent * MAX_DURATION;
                            const time = Math.round(rawTime * 2) / 2;

                            const segment = segments.find(s => s.id === segmentId);
                            const index = segments.findIndex(s => s.id === segmentId);
                            
                            if (!segment) return;

                            if (handleType === 'start' && index === 0) {
                                const newStart = Math.max(0, Math.min(time, segment.endTime - 0.5));
                                segment.startTime = newStart;
                            } else if (handleType === 'end') {
                                const newEnd = Math.max(segment.startTime + 0.5, Math.min(time, MAX_DURATION));
                                segment.endTime = newEnd;
                                
                                for (let i = index + 1; i < segments.length; i++) {
                                    const dur = segments[i].endTime - segments[i].startTime;
                                    segments[i].startTime = segments[i - 1].endTime;
                                    segments[i].endTime = Math.min(segments[i].startTime + dur, MAX_DURATION);
                                }
                            }

                            updateSliderUI(wrapper, segment, index);
                        };

                        const onEnd = () => {
                            document.removeEventListener('mousemove', onMove);
                            document.removeEventListener('mouseup', onEnd);
                            document.removeEventListener('touchmove', onMove);
                            document.removeEventListener('touchend', onEnd);
                            renderSegments();
                        };

                        document.addEventListener('mousemove', onMove);
                        document.addEventListener('mouseup', onEnd);
                        document.addEventListener('touchmove', onMove, { passive: false });
                        document.addEventListener('touchend', onEnd);
                    };
                    
                    handle.onmousedown = handleDrag;
                    handle.ontouchstart = handleDrag;
                });
            });
        }

        function updateSliderUI(wrapper, segment, index) {
            const startPercent = (segment.startTime / MAX_DURATION) * 100;
            const endPercent = (segment.endTime / MAX_DURATION) * 100;
            
            const range = wrapper.querySelector('.slider-range');
            const startHandle = wrapper.querySelector('[data-type="start"]');
            const endHandle = wrapper.querySelector('[data-type="end"]');
            const container = wrapper.closest('.segment');
            const timeDisplay = container.querySelector('.time-display');
            
            range.style.left = startPercent + '%';
            range.style.width = (endPercent - startPercent) + '%';
            startHandle.style.left = startPercent + '%';
            endHandle.style.left = endPercent + '%';
            
            timeDisplay.innerHTML = `
                <span class="time-value">Start: <strong>${segment.startTime.toFixed(1)}s</strong></span>
                <span class="time-value">End: <strong>${segment.endTime.toFixed(1)}s</strong></span>
            `;
            
            updatePrice();
        }

        function updatePrice() {
            let totalSeconds = 0;
            if (segments.length > 0) {
                const lastSegment = segments[segments.length - 1];
                totalSeconds = lastSegment.endTime;
            }
            
            const price = totalSeconds * RATE_PER_SECOND;
            
            document.getElementById('totalDuration').textContent = `${totalSeconds.toFixed(1)}s`;
            document.getElementById('priceCalc').textContent = `${totalSeconds.toFixed(1)}s × $${RATE_PER_SECOND.toFixed(2)}/s`;
            document.getElementById('priceValue').textContent = `$${price.toFixed(2)}`;
        }

        // Add segment button
        document.getElementById('addSegmentBtn').addEventListener('click', addSegment);

        // Generate PDF
        document.getElementById('generateBtn').addEventListener('click', generatePDF);

        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            
            const projectName = document.getElementById('projectName').value || 'Untitled Project';
            const projectGoal = document.getElementById('projectGoal').value || 'Not specified';
            const referenceLinks = document.getElementById('referenceLinks').value;
            
            // Calculate totals
            let totalSeconds = 0;
            if (segments.length > 0) {
                totalSeconds = segments[segments.length - 1].endTime;
            }
            const totalPrice = totalSeconds * RATE_PER_SECOND;
            
            // Colors
            const accentColor = selectedCompany === 'Alta' ? [124, 129, 250] : [220, 206, 158];
            const darkGray = [51, 51, 51];
            const midGray = [136, 136, 136];
            const lightGray = [153, 153, 153];
            
            const pageWidth = 210;
            const margin = 20;
            const contentWidth = pageWidth - (margin * 2);
            let y = margin;
            
            // Helper functions
            const setColor = (rgb) => doc.setTextColor(rgb[0], rgb[1], rgb[2]);
            const setFillColor = (rgb) => doc.setFillColor(rgb[0], rgb[1], rgb[2]);
            
            // Header
            doc.setFontSize(10);
            setColor(accentColor);
            doc.text('ANIMATION BRIEF', margin, y);
            y += 8;
            
            doc.setFontSize(22);
            doc.setFont('helvetica', 'bold');
            setColor(darkGray);
            doc.text(projectName, margin, y);
            
            // Price on right - smaller and lighter
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            setColor(midGray);
            doc.text('Estimate', pageWidth - margin, y - 5, { align: 'right' });
            doc.setFontSize(16);
            setColor(lightGray);
            doc.text('± $' + totalPrice.toFixed(2), pageWidth - margin, y + 2, { align: 'right' });
            
            y += 6;
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            setColor(midGray);
            doc.text(selectedCompany + ' • ' + new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }), margin, y);
            doc.setFontSize(9);
            doc.text(totalSeconds.toFixed(1) + 's × $' + RATE_PER_SECOND.toFixed(2) + '/s', pageWidth - margin, y, { align: 'right' });
            
            y += 12;
            
            // Divider
            setFillColor([238, 238, 238]);
            doc.rect(margin, y, contentWidth, 0.5, 'F');
            y += 8;
            
            // Overview boxes
            const boxWidth = contentWidth / 4;
            const boxes = [
                { label: 'FORMAT', value: formatNames[selectedFormat] },
                { label: 'DURATION', value: totalSeconds.toFixed(1) + 's' },
                { label: 'FEEL', value: easingNames[selectedEasing] },
                { label: 'SEGMENTS', value: segments.length.toString() }
            ];
            
            setFillColor([247, 247, 247]);
            doc.rect(margin, y, contentWidth, 18, 'F');
            
            boxes.forEach((box, i) => {
                const x = margin + (i * boxWidth) + 5;
                doc.setFontSize(8);
                setColor(lightGray);
                doc.text(box.label, x, y + 6);
                doc.setFontSize(11);
                doc.setFont('helvetica', 'bold');
                setColor(darkGray);
                doc.text(box.value, x, y + 13);
            });
            doc.setFont('helvetica', 'normal');
            
            y += 26;
            
            // Platforms section
            if (selectedPlatforms.length > 0) {
                doc.setFontSize(9);
                setColor(lightGray);
                doc.text('PLATFORMS', margin, y);
                y += 5;
                doc.setFontSize(10);
                setColor([85, 85, 85]);
                doc.text(selectedPlatforms.join(' • '), margin, y);
                y += 10;
            }
            
            // Goal section
            doc.setFontSize(9);
            setColor(lightGray);
            doc.text('GOAL', margin, y);
            y += 5;
            
            setFillColor([249, 249, 249]);
            doc.rect(margin, y, contentWidth, 20, 'F');
            setFillColor(accentColor);
            doc.rect(margin, y, 1, 20, 'F');
            
            doc.setFontSize(10);
            setColor(darkGray);
            const goalLines = doc.splitTextToSize(projectGoal, contentWidth - 10);
            doc.text(goalLines.slice(0, 3), margin + 5, y + 6);
            
            y += 28;
            
            // Mood
            if (selectedMoods.length > 0) {
                doc.setFontSize(9);
                setColor(lightGray);
                doc.text('MOOD & TONE', margin, y);
                y += 5;
                doc.setFontSize(10);
                setColor([85, 85, 85]);
                doc.text(selectedMoods.join(' • '), margin, y);
                y += 10;
            }
            
            // Timeline
            if (segments.length > 0 && totalSeconds > 0) {
                doc.setFontSize(9);
                setColor(lightGray);
                doc.text('TIMELINE', margin, y);
                y += 5;
                
                let xPos = margin;
                segments.forEach((seg, i) => {
                    const segWidth = ((seg.endTime - seg.startTime) / totalSeconds) * contentWidth;
                    setFillColor(accentColor);
                    doc.rect(xPos, y, segWidth - 1, 12, 'F');
                    
                    doc.setFontSize(7);
                    doc.setFont('helvetica', 'bold');
                    setColor([51, 51, 51]);
                    const segName = seg.name || 'Seg ' + (i + 1);
                    doc.text(segName, xPos + segWidth/2, y + 5, { align: 'center' });
                    doc.setFont('helvetica', 'normal');
                    doc.setFontSize(6);
                    doc.text((seg.endTime - seg.startTime).toFixed(1) + 's', xPos + segWidth/2, y + 9, { align: 'center' });
                    
                    xPos += segWidth;
                });
                
                y += 14;
                doc.setFontSize(8);
                setColor(lightGray);
                doc.text('0s', margin, y);
                doc.text(totalSeconds.toFixed(1) + 's', pageWidth - margin, y, { align: 'right' });
                y += 10;
            }
            
            // Segment details
            doc.setFontSize(9);
            setColor(lightGray);
            doc.text('SEGMENT DETAILS', margin, y);
            y += 6;
            
            segments.forEach((seg, i) => {
                // Check if we need a new page
                if (y > 260) {
                    doc.addPage();
                    y = margin;
                }
                
                const segHeight = 25 + (seg.copy ? 15 : 0) + (seg.visualDescription ? 15 : 0);
                
                // Border
                doc.setDrawColor(229, 229, 229);
                doc.rect(margin, y, contentWidth, segHeight);
                setFillColor(accentColor);
                doc.rect(margin, y, 1.5, segHeight, 'F');
                
                // Segment header
                doc.setFontSize(12);
                doc.setFont('helvetica', 'bold');
                setColor(darkGray);
                doc.text(seg.name || 'Segment ' + (i + 1), margin + 5, y + 7);
                
                doc.setFontSize(9);
                doc.setFont('helvetica', 'normal');
                setColor(midGray);
                const timeText = seg.startTime.toFixed(1) + 's – ' + seg.endTime.toFixed(1) + 's (' + (seg.endTime - seg.startTime).toFixed(1) + 's)';
                doc.text(timeText, pageWidth - margin - 5, y + 7, { align: 'right' });
                
                let innerY = y + 14;
                
                if (seg.copy) {
                    doc.setFontSize(7);
                    setColor(lightGray);
                    doc.text('ON-SCREEN COPY', margin + 5, innerY);
                    innerY += 4;
                    doc.setFontSize(9);
                    setColor(darkGray);
                    const copyLines = doc.splitTextToSize('"' + seg.copy + '"', contentWidth - 15);
                    doc.text(copyLines.slice(0, 2), margin + 5, innerY);
                    innerY += 10;
                }
                
                if (seg.visualDescription) {
                    doc.setFontSize(7);
                    setColor(lightGray);
                    doc.text('VISUAL DESCRIPTION', margin + 5, innerY);
                    innerY += 4;
                    doc.setFontSize(9);
                    setColor([85, 85, 85]);
                    const descLines = doc.splitTextToSize(seg.visualDescription, contentWidth - 15);
                    doc.text(descLines.slice(0, 2), margin + 5, innerY);
                }
                
                y += segHeight + 5;
            });
            
            // References
            if (uploadedFiles.length > 0 || referenceLinks) {
                if (y > 250) {
                    doc.addPage();
                    y = margin;
                }
                
                y += 5;
                doc.setFontSize(9);
                setColor(lightGray);
                doc.text('REFERENCES', margin, y);
                y += 6;
                
                if (uploadedFiles.length > 0) {
                    doc.setFontSize(9);
                    setColor(darkGray);
                    doc.text('Files: ' + uploadedFiles.map(f => f.name).join(', '), margin, y);
                    y += 6;
                }
                
                if (referenceLinks) {
                    doc.setFontSize(8);
                    setColor([85, 85, 85]);
                    const linkLines = doc.splitTextToSize(referenceLinks, contentWidth);
                    doc.text(linkLines.slice(0, 5), margin, y);
                }
            }
            
            // Deadline
            const deadlineValue = document.getElementById('deadlineDate').value;
            if (deadlineValue) {
                if (y > 250) {
                    doc.addPage();
                    y = margin;
                }
                
                y += 5;
                doc.setFontSize(9);
                setColor(lightGray);
                doc.text('DEADLINE', margin, y);
                y += 6;
                doc.setFontSize(10);
                setColor(darkGray);
                const deadlineDate = new Date(deadlineValue);
                doc.text(deadlineDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }), margin, y);
            }
            
            // Footer
            const footerY = 285;
            doc.setDrawColor(238, 238, 238);
            doc.line(margin, footerY - 5, pageWidth - margin, footerY - 5);
            
            // Save
            doc.save(projectName.replace(/[^a-z0-9]/gi, '_') + '_brief.pdf');
        }

        // Start with one segment
        addSegment();
    </script>
</body>
</html>
